"use strict";(globalThis.webpackChunkpage_render_service=globalThis.webpackChunkpage_render_service||[]).push([[9284],{9284:(e,a,t)=>{t.r(a),t.d(a,{default:()=>I});var r=t(467),n=t(4705),i=t(765),s=t(4612),l=t(5058),o=t(2342),c=t(3002),d=t(4478),u=t(7032),h=t(4067),v=t(8229),p=t(2367),m=t(4972),g="instagram-item",A=function(e,a,t){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],n=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return'<div class="_error-wrap">\n    <a \n      class="'.concat(arguments.length>5&&void 0!==arguments[5]?arguments[5]:"",'"\n      href="').concat(e,'"\n      target="').concat(r?"_blank":"_self",'"\n    >\n      <img src="').concat(a,'" alt=""/>\n    </a>\n    ').concat(n?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return'<div class="'.concat("instagram-caption",'">').concat(e,"</div>")}(t):"","\n  </div>\n")},f=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m.Ay;return'<div class="_error-wrap">\n    <div\n      class="instagram-thumb instagram-thumb_unavailable cropped square"\n    >\n      <img src="'.concat(e,'" alt=""/>\n    </div>\n  </div>\n')};class y extends p.A{constructor(){var e;super(...arguments),e=this,(0,n.A)(this,"init",(()=>{this.elInstagram=v.A.getCollection(this.selector),0!==this.elInstagram.length&&this.elInstagram.forEach(function(){var a=(0,r.A)((function*(a){var t=(0,i.A)(a,"dataset.settings",null);(0,l.A)(t)||(yield e.renderPosts(a,JSON.parse(t)))}));return function(e){return a.apply(this,arguments)}}())})),(0,n.A)(this,"instagramMedia",function(){var a=(0,r.A)((function*(a,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{var n=yield fetch(a);if(200===n.status||201===n.status){var i=yield n.text();return JSON.parse(i)}throw n}catch(n){return 5===r?404===(null==n?void 0:n.status)?null:{status:"server-error"}:yield e.instagramMedia(a,t,r+1)}}));return function(e,t){return a.apply(this,arguments)}}()),(0,n.A)(this,"renderEmptyPlace",((e,a)=>{var t=new Array(6).fill(1).map(((e,a)=>({id:a,isPlaceholder:!0})));(0,h.p3)(e,this.onResize(e)),t.forEach((t=>{var r=this.createImageElement(t,{className:a});e.append(r);var n=this.getImageSizeForDevice(e,(0,d.ZI)());v.A.updateStyle(r,n)})),v.A.show(e),v.A.hideOpacity(e)})),(0,n.A)(this,"prepareImages",(function(){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).slice(0,e).map((e=>{var{id:a,media_url:t,permalink:r,caption:n,thumbnail_url:i,media_type:s}=e;return{id:a,src:"VIDEO"===s?i:t,permalink:r,caption:n}}))})),(0,n.A)(this,"renderPosts",function(){var a=(0,r.A)((function*(a,t){var{accountId:r,amount:n,targetBlank:i,className:o,showCaption:c}=t,p=(0,u.A)(["apiUrls","embedApiService"],!1);if(r&&p){var m="".concat(p,"/feed/instagram/").concat(r,"?allTypes=true"),g=yield e.instagramMedia(m,a);if((0,l.A)(g)||(0,s.A)(g))e.renderEmptyPlace(a,o);else{var A={className:o,shouldShowCaption:c,shouldOpenInNewTab:i};if("server-error"===(null==g?void 0:g.status))return v.A.addClass(a,"_error"),void e.renderEmptyPlace(a,o);var f=e.prepareImages(g,n);(0,h.p3)(a,e.onResize(a)),v.A.show(a),f.forEach((t=>{var r=e.createImageElement(t,A);a.append(r);var n=e.getImageSizeForDevice(a,(0,d.ZI)());v.A.updateStyle(r,n)}))}}else e.renderEmptyPlace(a,o)}));return function(e,t){return a.apply(this,arguments)}}()),(0,n.A)(this,"createImageElement",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{className:a="",shouldShowCaption:t=!1,shouldOpenInNewTab:r=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,o.A)(e)||(0,s.A)(e))return null;var{caption:n,src:i,permalink:l,isPlaceholder:c}=e,d=v.A.createElement("div"),u=c?f:A;v.A.addClass(d,g),v.A.addHtml(d,u(l,i,n,r,t,a));var h=v.A.getElement("img",d),p=v.A.getElement("._error-wrap",d);return h.onerror=()=>{h.src=m.Ay,v.A.addClass(p,"picture-wrap_unavailable"),v.A.addClass(p,"picture-wrap_unavailable_hide")},d})),(0,n.A)(this,"resize",((e,a)=>{var t=this.getImageSizeForDevice(e,a);v.A.getCollection(".".concat(g),e).forEach((e=>v.A.updateStyle(e,t)))})),(0,n.A)(this,"getGridItemSize",((e,a)=>{var t=e.closest(".grid-component"),r=(0,c.df)(a)?c.Cx.maxColumnsMobile:c.Cx.maxColumns,n=(0,c.df)(a)?"coordinatesMobile":"coordinates",i=t.dataset[n]&&"null"!==t.dataset[n]?JSON.parse(t.dataset[n]):null;return Math.ceil(12*((null==i?void 0:i.width)||r)/r)})),(0,n.A)(this,"getImageSizeForDevice",((e,a)=>{var{settings:t={}}=e.dataset,{itemSize:r=c.VF,amountInRow:n=3}=JSON.parse(t),i=(0,u.A)("settings.grid"),s=(0,c.df)(a),l=i?this.getGridItemSize(e,a):r,o=i&&s?l:(0,c.XF)(l,a),d=(0,c.m8)(a,c.Xr),h=Math.ceil(o/c.VF*n*d);return{width:"".concat(100/h,"%")}})),(0,n.A)(this,"onResize",(e=>a=>this.resize(e,a)))}}const I=y}}]);